
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
  <title>Space Tetris</title>
  <style>
    html, body {
      margin: 0;
      padding: 0;
      font-family: sans-serif;
      height: 100%;
      overflow: hidden;
      background: black;
      color: white;
      display: flex;
      justify-content: center;
      align-items: center;
    }

    body::before {
      content: "";
      position: fixed;
      top: 0;
      left: 0;
      width: 200%;
      height: 200%;
      background: radial-gradient(circle, rgba(255,255,255,0.1) 1px, transparent 1px);
      background-size: 3px 3px;
      animation: stars 30s linear infinite;
      z-index: -1;
    }

    @keyframes stars {
      from { transform: translate(0, 0); }
      to { transform: translate(-50%, -50%); }
    }

    .btn {
      margin: 5px;
      padding: 10px 20px;
      font-size: 1.2em;
      background: #111;
      border: 2px solid #6fbaff;
      border-radius: 10px;
      color: #6fbaff;
      transition: 0.1s;
    }

    .btn:active {
      transform: scale(0.95);
      box-shadow: 0 0 12px #6fbaff;
    }

    #main-container {
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      height: 100vh;
    }

    #start-screen {
      position: absolute;
      inset: 0;
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      z-index: 10;
      background: black;
    }

    #game-ui {
      display: none;
      flex-direction: column;
      align-items: center;
      width: 100%;
      max-width: 480px;
    }

    #game-area {
      display: flex;
      flex-direction: row;
      justify-content: center;
      align-items: flex-start;
      gap: 10px;
    }

    canvas {
      border: 3px solid #6fbaff;
      box-shadow: 0 0 15px #6fbaff;
      background: rgba(0, 0, 0, 0.9);
    }

    #tetris {
      width: 90vw;
      max-width: 300px;
      aspect-ratio: 10/20;
    }

    #next {
      width: 60px;
      height: 60px;
      border: none;
      box-shadow: none;
      background: transparent;
    }

    #scorebar {
      margin-top: 10px;
      text-align: center;
      font-size: 1.1em;
    }

    #control-buttons {
      margin-top: 10px;
      display: flex;
      flex-wrap: wrap;
      justify-content: center;
      gap: 10px;
    }
  
    @media (max-width: 600px) {
      #tetris {
        width: 90vw;
        height: auto;
      }

      #next {
        width: 12vw;
        height: 12vw;
      }

      .btn {
        font-size: 1em;
        padding: 8px 14px;
      }

      #scorebar {
        font-size: 0.95em;
      }
    }

    canvas {
      max-width: 100%;
      height: auto;
    }

</style>
</head>
<body>
<div id="main-container">
  <div id="start-screen">
    <h1 style="font-size:8vw; margin-bottom:5vh; text-shadow:0 0 10px #6fbaff;">SPACE TETRIS</h1>
    <button class="btn" onclick="launchGame()">START</button>
  </div>

  <div id="game-ui">
    <div id="scorebar">
      Score: <span id="score">0</span> |
      High Score: <span id="highscore">0</span> |
      Level: <span id="level">1</span>
    </div>
    <div id="game-area">
      <div style="display:flex; flex-direction:column; align-items:center; margin-bottom:10px;">
  <canvas id="next" width="60" height="60" style="margin-bottom: 4px;"></canvas>
  <div style="font-size: 0.9em; color: #6fbaff;">Next</div>
</div>
      <canvas id="tetris" width="300" height="600"></canvas>
    </div>
    <div id="control-buttons">
      <button class="btn" onclick="moveLeft()">‚¨ÖÔ∏è</button>
      <button class="btn" onclick="rotatePiece()">üîÑ</button>
      <button class="btn" onclick="moveRight()">‚û°Ô∏è</button>
      <button class="btn" onclick="hardDrop()">‚¨áÔ∏è</button>
      <button class="btn" onclick="togglePause()">‚è∏Ô∏è</button>
      <button class="btn" onclick="launchGame()">üîÑ</button>
    </div>
  </div>
</div>

<script>
// Simplified game logic with next piece preview
const canvas = document.getElementById("tetris");
const nextCanvas = document.getElementById("next");
const ctx = canvas.getContext("2d");
const nextCtx = nextCanvas.getContext("2d");

const COLS = 10, ROWS = 20;
const BLOCK = canvas.width / COLS;
const NEXT_BLOCK = nextCanvas.width / 4;

const shapes = [
  { color: "#00f0f0", shape: [[1,1,1,1]] },
  { color: "#f0f000", shape: [[1,1],[1,1]] },
  { color: "#8000f0", shape: [[0,1,0],[1,1,1]] },
  { color: "#f00000", shape: [[1,0,0],[1,1,1]] },
  { color: "#0000f0", shape: [[0,0,1],[1,1,1]] },
  { color: "#00f000", shape: [[1,1,0],[0,1,1]] },
  { color: "#f0a000", shape: [[0,1,1],[1,1,0]] }
];

let grid, current, currentColor, px, py, score = 0, level = 1, dropInterval = 800;
let dropTimer = 0, lastTime = 0, paused = false, highScore = 0;
let nextPiece = null;

function initGrid() {
  grid = Array.from({ length: ROWS }, () => Array(COLS).fill(0));
}

function randomPiece() {
  return shapes[Math.floor(Math.random() * shapes.length)];
}

function drawMatrix(ctx, matrix, offsetX, offsetY, blockSize, color) {
  ctx.fillStyle = color;
  matrix.forEach((row, y) => {
    row.forEach((val, x) => {
      if (val) {
        ctx.fillRect((offsetX + x) * blockSize, (offsetY + y) * blockSize, blockSize - 1, blockSize - 1);
      }
    });
  });
}

function drawNext() {
  nextCtx.clearRect(0, 0, nextCanvas.width, nextCanvas.height);
  if (nextPiece) {
    const offsetX = 1, offsetY = 1;
    drawMatrix(nextCtx, nextPiece.shape, offsetX, offsetY, NEXT_BLOCK, nextPiece.color);
  }
}

function newPiece() {
  const piece = nextPiece || randomPiece();
  current = piece.shape;
  currentColor = piece.color;
  nextPiece = randomPiece();
  drawNext();
  px = 3;
  py = 0;
}

function draw() {
  ctx.clearRect(0, 0, canvas.width, canvas.height);
  grid.forEach((row, y) => {
    row.forEach((val, x) => {
      if (val) {
        ctx.fillStyle = val;
        ctx.fillRect(x * BLOCK, y * BLOCK, BLOCK - 1, BLOCK - 1);
      }
    });
  });
  drawMatrix(ctx, current, px, py, BLOCK, currentColor);
}

function collides(x, y, shape) {
  return shape.some((row, dy) =>
    row.some((val, dx) =>
      val && (y + dy >= ROWS || x + dx < 0 || x + dx >= COLS || grid[y + dy]?.[x + dx])
    )
  );
}

function merge() {
  current.forEach((row, y) => {
    row.forEach((val, x) => {
      if (val) grid[py + y][px + x] = currentColor;
    });
  });
}

function clearLines() {
  for (let y = ROWS - 1; y >= 0; y--) {
    if (grid[y].every(cell => cell)) {
      grid.splice(y, 1);
      grid.unshift(Array(COLS).fill(0));
      score += 100;
      level = 1 + Math.floor(score / 500);
      dropInterval = Math.max(200, 800 - level * 50);
      document.getElementById("score").textContent = score;
      document.getElementById("level").textContent = level;
    }
  }
}

function update(t = 0) {
  if (paused) return;
  const delta = t - lastTime;
  lastTime = t;
  dropTimer += delta;
  if (dropTimer > dropInterval) {
    py++;
    if (collides(px, py, current)) {
      py--;
      merge();
      clearLines();
      newPiece();
    }
    dropTimer = 0;
  }
  draw();
  requestAnimationFrame(update);
}

function moveLeft() { if (!collides(px - 1, py, current)) px--; }
function moveRight() { if (!collides(px + 1, py, current)) px++; }
function rotatePiece() {
  const rotated = current[0].map((_, i) => current.map(row => row[i])).reverse();
  if (!collides(px, py, rotated)) current = rotated;
}
function hardDrop() {
  while (!collides(px, py + 1, current)) py++;
}

function togglePause() { paused = !paused; if (!paused) update(); }

function startGame() {
  score = 0;
  level = 1;
  dropInterval = 800;
  dropTimer = 0;
  lastTime = 0;
  paused = false;
  highScore = parseInt(localStorage.getItem("highScore")) || 0;
  document.getElementById("score").textContent = score;
  document.getElementById("highscore").textContent = highScore;
  document.getElementById("level").textContent = level;
  initGrid();
  nextPiece = randomPiece();
  newPiece();
  update();
}

function launchGame() {
  document.getElementById("start-screen").style.display = "none";
  document.getElementById("game-ui").style.display = "flex";
  startGame();
}
</script>
</body>
</html>
